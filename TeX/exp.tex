\documentclass{article}

\usepackage[english, russian]{babel}
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}

\newcommand{\bfv}[1]{\mathbf{#1}}
\newcommand{\dd}[1]{\dot{#1}}
\newcommand{\dvp}[3]{#1\,\times\,[\,#2\,\times\,#3\,]}
\newcommand{\dv}[1]{\nabla v(#1)}
\newcommand{\ddv}[1]{\mathrm{D}[v](#1)}
\newcommand{\dr}{\delta \bfv{r}}
\newcommand{\dn}{\delta \bfv{n}}
\newcommand{\om}[1]{\mathrm{o}(#1)}
\newcommand{\dprod}[2]{\langle #1, #2 \rangle}
\newcommand{\T}[1]{#1^\mathrm{T}}
\newcommand{\matr}[1]{\mathrm{#1}}
\newcommand{\R}{\mathbb{R}}

\begin{document}
\noindentРассмотрим исходную систему бихарактеристик луча в переменных $\bfv{r}$ и $\bfv{n}$:
\begin{equation} \label{eq:1}
\begin{cases}
\dd{\bfv{r}} = v(\bfv{r})\,\bfv{n}\\
\dd{\bfv{n}} = \dvp{\bfv{n}}{\bfv{n}}{\dv{\bfv{r}}}\\
\end{cases}
\end{equation}
с начальными условиями $\bfv{r}|_{\tau=0} = \bfv{r}_0$ и $\bfv{n}|_{\tau=0} = \bfv{n}_0$\\\\
Из физических соображений $\bfv{n}$ --- единичная нормаль к волновому фронту $\Rightarrow \ \|\bfv{n}\| = 1$.\\ 
Воспользуемся тождеством Лагранжа для двойного векторного произведения $\dvp{\bfv{n}}{\bfv{n}}{\dv{\bfv{r}}}$:
\begin{equation} \label{eq:2}
    \dvp{\bfv{n}}{\bfv{n}}{\dv{\bfv{r}}} = \bfv{n}\,\dprod{\bfv{n}}{\dv{\bfv{r}}} - \dv{\bfv{r}}\,\dprod{\bfv{n}}{\bfv{n}} = \bfv{n}\,\dprod{\bfv{n}}{\dv{\bfv{r}}} - \dv{\bfv{r}}
\end{equation}\\
Подставляя \eqref{eq:2} в \eqref{eq:1}, получим:\\
\begin{equation} \label{eq:3}
\begin{cases}
\dd{\bfv{r}} = v(\bfv{r})\,\bfv{n}\\
\dd{\bfv{n}} =  \bfv{n}\,\dprod{\bfv{n}}{\dv{\bfv{r}}} - \dv{\bfv{r}}\\
\end{cases}
\end{equation}\\
Рассмотрим малое возмущение для $\bfv{r}$ и $\bfv{n}$:
\begin{align*}
\bfv{r_1} &= \bfv{r} + \dr   &   \bfv{n_1} &= \bfv{n} + \dr
\end{align*}
Будем считать, что в линейном приближении система \eqref{eq:3} выполнена для $\bfv{r_1}$ и $\bfv{n_1}$, то есть:\\
\begin{equation} \label{eq4}
\begin{cases}
\dd{\bfv{r_1}} = v(\bfv{r_1})\,\bfv{n_1} + \om{\|\dr\| + \|\dn\|}\\
\dd{\bfv{n_1}} = \bfv{n_1}\,\dprod{\bfv{n_1}}{\dv{\bfv{r_1}}} - \dv{\bfv{r_1}} + \om{\|\dr\| + \|\dn\|}\\
\end{cases}
\end{equation}\\
Положим $v(\bfv{r}) = a + b\,\bfv{r}_z$, тогда $\dv{\bfv{r}} = \T{(0,\,0,\,b)}, \ \forall r \in \R^3$, следовательно, для малого возмущения~$\dr$ разложение в ряд Тейлора будет иметь вид:
\begin{gather} \label{eq:5} 
v(\bfv{r} + \dr) = v(\bfv{r}) + \dprod{\dv{\bfv{r}}}{\dr} + \om{\|\dr\|} = a + b\,\bfv{r}_z + b\,\dr_z\\ 
\label{eq:6} 
\dv{\bfv{r} + \dr} = \dv{\bfv{r}} + \ddv{\bfv{r}}\,\dr + \om{\|\dr\|} = b\,\vec{e}
\end{gather}\\
Подставим \eqref{eq:1}, \eqref{eq:5} и \eqref{eq:6} в \eqref{eq4} и оставим только линейные по $\dr$ и $\dn$ члены. В результате, приводя подобные, получим:
\begin{equation} \label{eq:7}
\begin{cases}
\dd{\dr} = \bfv{n}\,\dprod{\dv{\bfv{r}}}{\dr} + v(\bfv{r})\,\dn\\
\dd{\dn} = \bfv{\dn}\,\dprod{\bfv{n}}{\dv{\bfv{r}}} + \bfv{n}\,\dprod{\bfv{\dn}}{\dv{\bfv{r}}}
\end{cases}
\end{equation}\\
В матричном виде \eqref{eq:7}:
\begin{equation} \label{eq:8}
\begin{bmatrix}
    \dd{\dr}\\
    \dd{\dn}
\end{bmatrix} = \matr{M}(\tau) 
\begin{bmatrix}
    \dr\\
    \dn
\end{bmatrix},
\end{equation} где $ M(\tau) = \begin{bmatrix}
    0 & 0 & b\,n_x & a + b\,r_x & 0 & 0\\
    0 & 0 & b\,n_y & 0 & a + b\,r_y & 0\\
    0 & 0 & b\,n_z & 0 & 0 & a + b\,r_z\\
    0 & 0 & 0 & b\,n_x & 0 & b\,n_x\\
    0 & 0 & 0 & 0 & b\,n_y & b\,n_y\\
    0 & 0 & 0 & 0 & 0 & 2\,b\,n_z
\end{bmatrix}$, $\bfv{r} \equiv \bfv{r}(\tau)$, $\bfv{n} \equiv \bfv{n}(\tau)$\\\\
В силу сферичности фронта положим $\dr = \matr{P}(\tau)\,\dn_0$ и $\dn = \matr{Q}(\tau)\,\dn_0$ и, подставляя в \eqref{eq:8} и группирую по компонентам $\dn_0$, получим следующую систему:\\
\begin{equation} \label{eq:9}
\begin{bmatrix}
    \dd{\matr{P}}\\
    \dd{\matr{Q}}
\end{bmatrix} = \matr{M}(\tau) 
\begin{bmatrix}
    \matr{P}\\
    \matr{Q}
\end{bmatrix},
\end{equation}\\
с начальными условиями $\matr{P}|_{\tau=0} = \matr{0}$ и $\matr{Q}|_{\tau=0} = \matr{I}$\\\\
Разобьем систему \eqref{eq:9} на блоки:
\begin{equation} \label{eq:10}
\begin{cases}
\dd{\matr{P}} = \matr{M}_{11}(\tau)\,\matr{P} + \matr{M}_{12}(\tau)\,\matr{Q}\\
\dd{\matr{Q}} = \matr{M}_{22}(\tau)\,\matr{Q}\\
\matr{P}|_{\tau=0} = \matr{0}, \ \matr{Q}|_{\tau=0} = \matr{I}
\end{cases}
\end{equation}\\\\
Легко видеть, что решение первого уравнения зависит от решения второго, однако решение второго не зависит от первого. Следовательно, система распадается на две системы из трех дифференциальных уравнений (в силу того, что матрицы $\matr{M}_{11}$, $\matr{M}_{12}$ и $\matr{M}_{22}$ полного ранга), решаемых последовательно.\\
\begin{align*}
\begin{cases}
\dd{\matr{Q}} = \matr{M}_{22}(\tau)\,\matr{Q}\\
\matr{Q}|_{\tau=0} = \matr{I}
\end{cases}   
\quad & \quad   
\begin{cases}
\dd{\matr{P}} = \matr{M}_{11}(\tau)\,\matr{P} + \matr{M}_{12}(\tau)\,\matr{Q}\\
\matr{P}|_{\tau=0} = \matr{0}
\end{cases} 
\end{align*}\\
Найдем аналитическое решение первой из этих систем. В силу того, что $\matr{M}_{22}(\tau) \equiv \matr{M}_{22}(\bfv{n}(\tau))$, то для нахождения $\matr{M}_{22}$ необходимо лишь $\bfv{n}$.\\\\
Для нахождения $\bfv{n}$ в общем случае необходимо найти решение \eqref{eq:1}, однако, так как $\dv{\bfv{r}}$~--~const, то $\bfv{n}$ не зависит от $\bfv{r}$. Следовательно, необходимо решать следующую систему:
\begin{equation} \label{eq:11}
\begin{cases}
\dd{\bfv{n}} = (b\,\bfv{n}_z)\bfv{n} - \T{(0,\,0,\,b)}\\
\bfv{n}|_{\tau=0} = \bfv{n}_0
\end{cases}
\end{equation}\\
Заметим также, что задача радиально симметрична вдоль оси $OZ$, и, в силу равенства $\|\bfv{n}\| = 1$, $\bfv{n_0}$ можно представить в виде: $\bfv{n_0} = \T{(\sin(\alpha),\,0,\,\cos(\alpha))}$, где $\alpha$ --- угол отклонения от оси $OZ$. Из физического смысла задачи $\alpha \in [-\frac{\pi}{2},\,\frac{\pi}{2}]$\\\\
В распишем систему \eqref{eq:11} по компонентам $\bfv{n}$:
\begin{equation} \label{eq:12}
\begin{cases}
\dd{\bfv{n}_x} = b\,\bfv{n}_z\,\bfv{n}_x\\
\dd{\bfv{n}_y} = b\,\bfv{n}_z\,\bfv{n}_x\\
\dd{\bfv{n}_z} = b\,(\bfv{n}_z^2 - 1)\\
\bfv{n}_{x0} = \sin(a)\\
\bfv{n}_{y0} = 0\\
\bfv{n}_{z0} = \cos(0)
\end{cases}
\end{equation}\\
Ее общее решение имеет вид:
\begin{equation*}
\begin{cases}
\bfv{n}_x = \dfrac{C_1}{(C_3\,\exp(\frac{t}{2b}) - 1)^2}\,\exp(bt)\\\\
\bfv{n}_y = \dfrac{C_2}{(C_3\,\exp(\frac{t}{2b}) - 1)^2}\,\exp(bt)\\\\
\bfv{n}_z = -\dfrac{C_3\,\exp(\frac{t}{2b}) - 1}{C_3\,\exp(\frac{t}{2b}) + 1}
\end{cases}
\end{equation*}\\
Подставляя начальные условия:
\begin{equation} \label{eq:13}
\begin{cases}
\bfv{n}_x = \dfrac{4\sin(a)}{((\cos(a) - 1)\,\exp(\frac{t}{2\,b}) - (\cos(a) + 1))^2}\,\exp(bt)\\\\
\bfv{n}_y = 0\\\\
\bfv{n}_z = -\dfrac{(\cos(a) - 1)\,\exp(\frac{t}{2\,b}) + (\cos(a) + 1)}{(\cos(a) - 1)\,\exp(\frac{t}{2\,b}) - (\cos(a) + 1)}
\end{cases}
\end{equation}\\\\
Для решения уравнения с матрицей $\matr{Q}$ воспользуемся тем фактом, что она симметричная (следует из того, что она задает производную).\\\\
Из матрицы $\matr{M}_{22}(\tau)$ следует, что строка $\bfv{q}_3$ не зависит от других, то есть:
\begin{equation} \label{eq:14}
\begin{cases}
\bfv{q}_{3} = \bfv{q}_{3}^0\,\exp\big{(}\int_0^\tau 2b\,\bfv{n}_z \ d\tau\big{)}\\
\bfv{q}_{3}^0 = \T{(0,\,0,\,1)}
\end{cases}
\end{equation}\\
Отсюда легко видеть, что $\bfv{q}_{13} = \bfv{q}_{23} = 0$, а следовательно, рассуждая аналогично с учетом данных равенств для строки $q_2$, и $\bfv{q}_{12} = 0$. Это означает равенство нулю внедиагональных элементов матрицы $\matr{Q}$.\\\\
Исходя из этого запишем решение уравнения для $\matr{Q}$:
\begin{equation} \label{eq:13}
\begin{cases}
\bfv{q}_{11} = \exp\big{(}\int_0^\tau b\,\bfv{n}_x \ d\tau\big{)}\\
\bfv{q}_{22} = \exp\big{(}\int_0^\tau b\,\bfv{n}_y \ d\tau\big{)}\\
\bfv{q}_{33} = \exp\big{(}\int_0^\tau 2b\,\bfv{n}_z \ d\tau\big{)}\\
\bfv{q}_{ij} = 0, \ \text{если} \ i \neq j
\end{cases}
\end{equation}\\\\
\end{document}